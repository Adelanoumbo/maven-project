pipeline {
  agent none
    options {
    buildDiscarder(logRotator(numToKeepStr: '20'))
    disableConcurrentBuilds()
    timeout (time: 10, unit: 'MINUTES')
    timestamps()
  }
  stages {
    stage('Build') {
          agent {         
       docker {          
         image 'maven'         
            }       
          }

      steps {
         sh 'mvn clean'
      }
    }



        stage("SonarQube test") { 
          agent {         
       docker {          
         image 'maven'         
            }       
          }   
     steps {
              withSonarQubeEnv('Sonar') {
                sh 'mvn clean  sonar:sonar'
            }
            
        }
    }






  }
}


